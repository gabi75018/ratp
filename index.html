<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Panel d'Ã©vÃ©nements - Simulation</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #1b1b1b;
        color: white;
        display: flex;
        height: 100vh;
    }
    header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: #111;
        padding: 10px;
        text-align: center;
        z-index: 10;
        border-bottom: 2px solid #333;
    }
    .container {
        display: flex;
        width: 100%;
        margin-top: 60px;
    }
    .column {
        flex: 1;
        padding: 10px;
        overflow-y: auto;
        border-right: 2px solid #333;
    }
    .column:last-child {
        border-right: none;
    }
    .card {
        background: #2a2a2a;
        padding: 10px;
        margin-bottom: 10px;
        border-left: 5px solid #555;
    }
    .btn {
        padding: 6px 10px;
        margin: 3px;
        background: #444;
        border: none;
        color: white;
        cursor: pointer;
        font-size: 12px;
    }
    .btn:hover {
        background: #666;
    }
    .service-btn {
        background: #0055aa;
    }
    .service-btn:hover {
        background: #0077dd;
    }
    textarea, input, select {
        width: 100%;
        background: #222;
        color: white;
        border: 1px solid #444;
        padding: 5px;
        margin-bottom: 5px;
        font-size: 12px;
    }
    textarea {
        height: 70px;
    }
    .section-title {
        font-size: 18px;
        margin-bottom: 10px;
        border-bottom: 1px solid #444;
        padding-bottom: 5px;
    }
    .small-label {
        font-size: 11px;
        color: #ccc;
    }
    .row {
        display: flex;
        gap: 5px;
    }
    .row > div {
        flex: 1;
    }
    .badge {
        display: inline-block;
        padding: 2px 6px;
        font-size: 11px;
        border-radius: 3px;
        margin-right: 4px;
    }
    .prio-P0 { background:#b30000; }
    .prio-P1 { background:#e67300; }
    .prio-P2 { background:#999900; }
    .prio-P3 { background:#555555; }
</style>

<!-- Sons par prioritÃ© -->
<audio id="soundP0" src="https://actions.google.com/sounds/v1/alarms/alarm_clock.ogg"></audio>
<audio id="soundP1" src="https://actions.google.com/sounds/v1/alarms/beep_short.ogg"></audio>
<audio id="soundP2" src="https://actions.google.com/sounds/v1/cartoon/cartoon_boing.ogg"></audio>
<audio id="soundP3" src="https://actions.google.com/sounds/v1/cartoon/pop.ogg"></audio>

</head>
<body>

<header>
    <h2>Panel d'Ã©vÃ©nements â€“ Simulation</h2>
    <div id="stats"></div>
</header>

<div class="container">

    <!-- FILE D'Ã‰VÃ‰NEMENTS -->
    <div class="column">
        <div class="section-title">ðŸ“¥ Ã‰vÃ©nements entrants</div>
        <div id="queue-list"></div>
    </div>

    <!-- Ã‰VÃ‰NEMENT ACTIF / DOSSIER -->
    <div class="column">
        <div class="section-title">ðŸ“‚ Dossier en cours</div>
        <div id="active-event">Aucun Ã©vÃ©nement sÃ©lectionnÃ©.</div>
    </div>

    <!-- DOSSIERS ENVOYÃ‰S + HISTORIQUE -->
    <div class="column">
        <div class="section-title">ðŸš€ Dossiers envoyÃ©s</div>
        <div id="actions"></div>

        <div class="section-title" style="margin-top:20px;">ðŸ“š Historique</div>
        <div id="history"></div>
    </div>

</div>

<script>
/* ------------------------------
   SCÃ‰NARIOS NEUTRES
--------------------------------*/
const SCENARIOS = [
    {label:"ArrÃªt cardio-respiratoire", type:"MÃ©dical", prio:"P0", desc:"Victime inconsciente, respiration absente.", victims:1, env:"Domicile"},
    {label:"Feu d'appartement", type:"Incendie", prio:"P0", desc:"FumÃ©e noire, personnes coincÃ©es.", victims:2, env:"Immeuble"},
    {label:"Accident frontal", type:"Accident", prio:"P1", desc:"Deux voitures, un coincÃ©.", victims:1, env:"Route"},
    {label:"Chute d'un balcon", type:"Accident", prio:"P0", desc:"Chute signalÃ©e.", victims:1, env:"Immeuble"},
    {label:"DÃ©but d'incendie de vÃ©hicule", type:"Incendie", prio:"P0", desc:"Flammes lÃ©gÃ¨res.", victims:0, env:"Parking"},
    {label:"Personne bloquÃ©e dehors", type:"Divers", prio:"P1", desc:"Porte claquÃ©e.", victims:0, env:"Domicile"},
    {label:"Signalement de bruit suspect", type:"Police", prio:"P1", desc:"Bruits inhabituels.", victims:0, env:"Immeuble"},
    {label:"Personne bloquÃ©e dans ascenseur", type:"Technique", prio:"P0", desc:"Ascenseur immobilisÃ©.", victims:1, env:"Immeuble"},
    {label:"Agression couteau", type:"Agression", prio:"P0", desc:"Victime poignardÃ©e, saigne abondamment.", victims:1, env:"Voie publique"},
    {label:"Vieil homme perdu", type:"MÃ©dical", prio:"P2", desc:"Confusion, marche instable.", victims:1, env:"Parc"},
    {label:"Odeur de gaz", type:"Risque", prio:"P1", desc:"Odeur forte dans immeuble.", victims:0, env:"Immeuble"},
    {label:"OVNI sur le toit", type:"Bizarre", prio:"P3", desc:"Personne dit Ãªtre observÃ©e.", victims:0, env:"Immeuble"},
    {label:"Enfant qui rigole", type:"Douteux", prio:"P3", desc:"Probable canular.", victims:0, env:"Domicile"},
    {label:"Suicide pont", type:"Critique", prio:"P0", desc:"Personne sur rebord.", victims:1, env:"Pont"},
    {label:"Malaise mÃ©tro", type:"MÃ©dical", prio:"P1", desc:"Victime au sol, respiration difficile.", victims:1, env:"Transport"},
    {label:"Voisin se prend pour un poulet", type:"Bizarre", prio:"P3", desc:"Crie depuis 20 minutes.", victims:0, env:"Immeuble"},
    {label:"Course poursuite scooter", type:"Police", prio:"P1", desc:"Scooter refuse d'obtempÃ©rer.", victims:0, env:"Route"},
    {label:"Fuite importante d'eau", type:"Technique", prio:"P0", desc:"Inondation en cours.", victims:0, env:"Appartement"},
    {label:"Signalement d'odeur forte", type:"Risque", prio:"P0", desc:"Odeur inhabituelle.", victims:0, env:"Cage d'escalier"},
    {label:"Accident de trottinette", type:"Accident", prio:"P0", desc:"Personne au sol.", victims:1, env:"Rue"},
    {label:"Chute d'un toit", type:"Accident", prio:"P0", desc:"Personne au sol.", victims:1, env:"Chantier"},
    {label:"DÃ©clenchement d'alarme incendie", type:"Incendie", prio:"P0", desc:"Alarme active.", victims:0, env:"BÃ¢timent"},
    {label:"Trafic suspect", type:"Douanes", prio:"P2", desc:"Chargements nocturnes suspects.", victims:0, env:"Zone industrielle"},
    {label:"Bagarre gÃ©nÃ©rale", type:"Agression", prio:"P1", desc:"Plusieurs blessÃ©s possibles.", victims:2, env:"Voie publique"},
    {label:"Chute d'un toit", type:"Accident", prio:"P0", desc:"Victime inconsciente.", victims:1, env:"Chantier"},
    {label:"Crise d'Ã©pilepsie", type:"MÃ©dical", prio:"P1", desc:"Convulsions en cours.", victims:1, env:"Lieu public"},
    {label:"Ascenseur bloquÃ©", type:"Risque", prio:"P2", desc:"Personne enfermÃ©e, panique.", victims:1, env:"Immeuble"},
    {label:"Complot imaginaire", type:"Bizarre", prio:"P3", desc:"Parle de camÃ©ras cachÃ©es.", victims:0, env:"Inconnu"},
    {label:"Violences conjugales", type:"Police", prio:"P1", desc:"Cris, bruits de coups.", victims:1, env:"Domicile"},
    {label:"Accrochage de vÃ©hicules", type:"Accident", prio:"P1", desc:"Deux vÃ©hicules touchÃ©s.", victims:0, env:"Rue"},
    {label:"Personne bloquÃ©e dehors", type:"Divers", prio:"P1", desc:"Porte claquÃ©e.", victims:0, env:"Domicile"},
    {label:"Signalement de bruit suspect", type:"Police", prio:"P1", desc:"Bruits inhabituels.", victims:0, env:"Immeuble"},
    {label:"Intox alcool + chute", type:"MÃ©dical", prio:"P2", desc:"Plaie tÃªte, alcoolisÃ©.", victims:1, env:"Domicile"},
    {label:"Explosion entendue", type:"Risque", prio:"P1", desc:"DÃ©tonation forte, fumÃ©e.", victims:0, env:"Rue"},
    {label:"Cri animal Ã©trange", type:"Bizarre", prio:"P3", desc:"Appelant parle d'un monstre.", victims:0, env:"ForÃªt"},
    {label:"Fuite chimique", type:"Risque", prio:"P0", desc:"Odeur piquante, irritation yeux.", victims:1, env:"Usine"},
    {label:"Malaise sur la voie publique", type:"MÃ©dical", prio:"P0", desc:"Personne au sol.", victims:1, env:"Rue"},
    {label:"FumÃ©e dans un appartement", type:"Incendie", prio:"P0", desc:"FumÃ©e visible.", victims:0, env:"Immeuble"},
    {label:"Chute d'un balcon", type:"Accident", prio:"P0", desc:"Chute signalÃ©e.", victims:1, env:"Immeuble"},
    {label:"DÃ©but d'incendie de vÃ©hicule", type:"Incendie", prio:"P0", desc:"Flammes lÃ©gÃ¨res.", victims:0, env:"Parking"},
    {label:"Personne bloquÃ©e dans ascenseur", type:"Technique", prio:"P0", desc:"Ascenseur immobilisÃ©.", victims:1, env:"Immeuble"},
    {label:"Tapage important", type:"Police", prio:"P1", desc:"Nuisances sonores.", victims:0, env:"Immeuble"},
    {label:"DÃ©gradation de mobilier urbain", type:"Police", prio:"P1", desc:"DÃ©gradations signalÃ©es.", victims:0, env:"Rue"},
    {label:"Animal errant", type:"Divers", prio:"P1", desc:"Animal signalÃ©.", victims:0, env:"Parc"},
    {label:"Fuite lÃ©gÃ¨re d'eau", type:"Technique", prio:"P1", desc:"Eau au sol.", victims:0, env:"Appartement"},
    {label:"Personne dÃ©sorientÃ©e", type:"Police", prio:"P1", desc:"Comportement inhabituel.", victims:1, env:"Rue"},
    {label:"Objets tombÃ©s d'un balcon", type:"Police", prio:"P1", desc:"Chute d'objets.", victims:0, env:"Immeuble"},
    {label:"Petit feu de poubelle", type:"Incendie", prio:"P1", desc:"FumÃ©e lÃ©gÃ¨re.", victims:0, env:"Rue"},
    {label:"Accrochage de vÃ©hicules", type:"Accident", prio:"P1", desc:"Deux vÃ©hicules touchÃ©s.", victims:0, env:"Rue"},
    {label:"Personne bloquÃ©e dehors", type:"Divers", prio:"P1", desc:"Porte claquÃ©e.", victims:0, env:"Domicile"},
    {label:"Signalement de bruit suspect", type:"Police", prio:"P1", desc:"Bruits inhabituels.", victims:0, env:"Immeuble"},
    {label:"Demande d'intervention mairie", type:"Mairie", prio:"P2", desc:"ProblÃ¨me d'Ã©clairage.", victims:0, env:"Rue"},
    {label:"Nid-de-poule important", type:"Mairie", prio:"P2", desc:"ChaussÃ©e abÃ®mÃ©e.", victims:0, env:"Route"},
    {label:"Arbre gÃªnant la circulation", type:"Mairie", prio:"P2", desc:"Branche tombÃ©e.", victims:0, env:"Rue"},
    {label:"Signalement de scooter gÃªnant", type:"Police", prio:"P2", desc:"Stationnement gÃªnant.", victims:0, env:"Trottoir"},
    {label:"Demande de vÃ©rification compteur", type:"Technique", prio:"P2", desc:"Suspicion anomalie.", victims:0, env:"Appartement"},
    {label:"Bruit de ventilation", type:"Technique", prio:"P2", desc:"Bruit persistant.", victims:0, env:"Immeuble"},
    {label:"Petit dÃ©gÃ¢t des eaux", type:"Technique", prio:"P2", desc:"HumiditÃ© murale.", victims:0, env:"Appartement"},
    {label:"Demande d'information mairie", type:"Mairie", prio:"P2", desc:"Renseignement demandÃ©.", victims:0, env:"Bureau"},
    {label:"Signalement de vÃ©hicule abandonnÃ©", type:"Police", prio:"P2", desc:"VÃ©hicule immobile.", victims:0, env:"Rue"},
    {label:"ProblÃ¨me de portail automatique", type:"Technique", prio:"P2", desc:"Portail bloquÃ©.", victims:0, env:"RÃ©sidence"},
    {label:"Signalement de nuisance lÃ©gÃ¨re", type:"Police", prio:"P2", desc:"Bruit modÃ©rÃ©.", victims:0, env:"Immeuble"},
    {label:"Demande de passage SOS MÃ©decin", type:"MÃ©dical", prio:"P2", desc:"Consultation souhaitÃ©e.", victims:1, env:"Domicile"},
    {label:"Demande de renseignement", type:"Divers", prio:"P3", desc:"Information gÃ©nÃ©rale.", victims:0, env:"TÃ©lÃ©phone"},
    {label:"Signalement de lumiÃ¨re restÃ©e allumÃ©e", type:"Mairie", prio:"P3", desc:"Ã‰clairage inutile.", victims:0, env:"Rue"},
    {label:"Petit bruit dans un local", type:"Technique", prio:"P3", desc:"Bruit lÃ©ger.", victims:0, env:"Local"},
    {label:"Demande de conseil", type:"Divers", prio:"P3", desc:"Besoin d'avis.", victims:0, env:"TÃ©lÃ©phone"},
    {label:"VÃ©rification de badge d'accÃ¨s", type:"SÃ©curitÃ©", prio:"P3", desc:"Badge non reconnu.", victims:0, env:"EntrÃ©e"},
    {label:"Signalement de vÃ©lo mal attachÃ©", type:"Police", prio:"P3", desc:"VÃ©lo instable.", victims:0, env:"Rue"},
    {label:"Demande de passage mairie", type:"Mairie", prio:"P3", desc:"Simple vÃ©rification.", victims:0, env:"Quartier"},
    {label:"Demande de contact gendarmerie", type:"Gendarmerie", prio:"P3", desc:"Renseignement.", victims:0, env:"TÃ©lÃ©phone"},
    {label:"Demande de contact police", type:"Police", prio:"P3", desc:"Information simple.", victims:0, env:"TÃ©lÃ©phone"},
    {label:"Demande de contact pompiers", type:"Pompiers", prio:"P3", desc:"Renseignement.", victims:0, env:"TÃ©lÃ©phone"},
    {label:"Signalement de panneau penchÃ©", type:"Mairie", prio:"P3", desc:"Panneau instable.", victims:0, env:"Rue"},
    {label:"Demande de passage technique", type:"Technique", prio:"P3", desc:"ContrÃ´le lÃ©ger.", victims:0, env:"Immeuble"},
    {label:"Signalement de bruit de ventilation", type:"Technique", prio:"P3", desc:"Bruit faible.", victims:0, env:"Cave"}
];

/* ------------------------------
   VARIABLES
--------------------------------*/
let queue = [];
let activeEvent = null;
let actions = [];
let history = [];
let eventID = 1;

/* ------------------------------
   SONS PAR PRIORITÃ‰
--------------------------------*/
function playPrioritySound(prio) {
    const audio = document.getElementById("sound" + prio);
    if (audio) {
        // certains navigateurs exigent une interaction avant le son
        audio.currentTime = 0;
        audio.play().catch(()=>{});
    }
}

/* ------------------------------
   GÃ‰NÃ‰RATION D'Ã‰VÃ‰NEMENTS
--------------------------------*/
function generateEvent() {
    const s = SCENARIOS[Math.floor(Math.random()*SCENARIOS.length)];
    const ev = {
        id: eventID++,
        scenario: s,
        time: new Date().toLocaleTimeString(),
        location: randomLocation(),
        comments: [],
        services: [],
        dossierSent: false,
        // champs libres
        freeDesc: "",
        gravity: s.prio,
        env: s.env,
        tag: "",
        impactScope: "Inconnu",
        userAffected: "Inconnu",
        workaround: "Inconnu"
    };
    queue.push(ev);
    renderQueue();
    playPrioritySound(s.prio);
}

function randomLocation() {
    const zones = ["Zone A", "Zone B", "Zone C", "Cluster 1", "Cluster 2", "Segment X", "Segment Y"];
    return zones[Math.floor(Math.random()*zones.length)];
}

/* ------------------------------
   AFFICHAGE FILE
--------------------------------*/
function renderQueue() {
    const div = document.getElementById("queue-list");
    div.innerHTML = "";
    queue.forEach(ev => {
        div.innerHTML += `
            <div class="card">
                <b>#${ev.id}</b> â€“ ${ev.scenario.label}<br>
                <span class="badge prio-${ev.scenario.prio}">${ev.scenario.prio}</span>
                <span class="small-label">${ev.scenario.type}</span><br>
                ${ev.location}<br>
                <span class="small-label">ReÃ§u Ã  ${ev.time}</span><br>
                <button class="btn" onclick="takeEvent(${ev.id})">Prendre en charge</button>
            </div>
        `;
    });
}

/* ------------------------------
   PRENDRE UN Ã‰VÃ‰NEMENT
--------------------------------*/
function takeEvent(id) {
    activeEvent = queue.find(e => e.id === id);
    queue = queue.filter(e => e.id !== id);
    renderQueue();
    renderActiveEvent();
}

/* ------------------------------
   AFFICHAGE DOSSIER
--------------------------------*/
function renderActiveEvent() {
    if (!activeEvent) {
        document.getElementById("active-event").innerHTML = "Aucun Ã©vÃ©nement sÃ©lectionnÃ©.";
        return;
    }

    const e = activeEvent;

    document.getElementById("active-event").innerHTML = `
        <div class="card">
            <h3>Dossier #${e.id} ${e.dossierSent ? "(envoyÃ© â€“ modifiable)" : "(Ã  complÃ©ter)"}</h3>
            <div class="small-label">ReÃ§u Ã  ${e.time} â€“ ${e.location}</div>
            <b>${e.scenario.label}</b><br>
            Type : ${e.scenario.type} â€“ 
            <span class="badge prio-${e.scenario.prio}">${e.scenario.prio}</span><br>
            <p>${e.scenario.desc}</p>

            <h4>Description libre</h4>
            <textarea id="freeDesc">${e.freeDesc}</textarea>

            <h4>Ã‰valuation</h4>
            <div class="row">
                <div>
                    <label class="small-label">GravitÃ©</label>
                    <select id="gravity">
                        ${["P0","P1","P2","P3"].map(p=>`<option value="${p}" ${e.gravity===p?"selected":""}>${p}</option>`).join("")}
                    </select>
                </div>
                <div>
                    <label class="small-label">DangeurositÃ©</label>
                    <select id="env">
                        ${["Faible","PrÃ©sente","Importante","Certaine"].map(v=>`<option value="${v}" ${e.env===v?"selected":""}>${v}</option>`).join("")}
                    </select>
                </div>
            </div>

            <div class="row">
                <div>
                    <label class="small-label">Nombre de personnes</label>
                    <select id="impactScope">
                        ${["1","2","3","+4","+6","+10","+30","+100"].map(v=>`<option value="${v}" ${e.impactScope===v?"selected":""}>${v}</option>`).join("")}
                    </select>
                </div>
                <div>
                    <label class="small-label">Utilisateurs affectÃ©s</label>
                    <select id="userAffected">
                        ${["Inconnu","Peu","Beaucoup","Critique"].map(v=>`<option value="${v}" ${e.userAffected===v?"selected":""}>${v}</option>`).join("")}
                    </select>
                </div>
            </div>

            <div class="row">
                <div>
                    <label class="small-label">Contournement possible</label>
                    <select id="workaround">
                        ${["Inconnu","Oui","Non"].map(v=>`<option value="${v}" ${e.workaround===v?"selected":""}>${v}</option>`).join("")}
                    </select>
                </div>
                <div>
                    <label class="small-label">Tag / catÃ©gorie libre</label>
                    <input id="tag" value="${e.tag}">
                </div>
            </div>

            <h4>Commentaires</h4>
            <textarea id="comment"></textarea>
            <button class="btn" onclick="addComment()">Ajouter commentaire</button>
            <div id="comment-list">${e.comments.map(cm=>"<div>â€¢ "+cm+"</div>").join("")}</div>

            <h4>Actions / Services</h4>
            ${serviceButton("Police")}
            ${serviceButton("Gendarmerie")}
            ${serviceButton("Pompiers")}
            ${serviceButton("Samu")}
            ${serviceButton("SOS Medecin")}
            ${serviceButton("Mairie de Paris")}
            ${serviceButton("Sans intervention")}

            <h4>Validation</h4>
            <button class="btn" onclick="saveCoreFields()">ðŸ’¾ Sauvegarder</button>
            <button class="btn" onclick="sendDossier()">ðŸ“¤ Envoyer dossier</button>
            <button class="btn" onclick="closeEvent()">âœ… ClÃ´turer</button>
        </div>
    `;
}

function serviceButton(name) {
    return `<button class="btn service-btn" onclick="sendService('${name}')">${name}</button>`;
}

/* ------------------------------
   SAUVEGARDE
--------------------------------*/
function saveCoreFields() {
    if (!activeEvent) return;
    const e = activeEvent;
    e.freeDesc = document.getElementById("freeDesc").value;
    e.gravity = document.getElementById("gravity").value;
    e.env = document.getElementById("env").value;
    e.impactScope = document.getElementById("impactScope").value;
    e.userAffected = document.getElementById("userAffected").value;
    e.workaround = document.getElementById("workaround").value;
    e.tag = document.getElementById("tag").value;
}

/* ------------------------------
   ENVOI DU DOSSIER
--------------------------------*/
function sendDossier() {
    if (!activeEvent) return;
    saveCoreFields();
    activeEvent.dossierSent = true;

    const existing = actions.find(a => a.id === activeEvent.id);
    if (!existing) {
        actions.push({
            id: activeEvent.id,
            label: activeEvent.scenario.label,
            time: new Date().toLocaleTimeString(),
            services: [...activeEvent.services]
        });
    } else {
        existing.services = [...activeEvent.services];
    }
    renderActions();
    renderActiveEvent();
}

/* ------------------------------
   COMMENTAIRES
--------------------------------*/
function addComment() {
    if (!activeEvent) return;
    const txt = document.getElementById("comment").value.trim();
    if (!txt) return;
    activeEvent.comments.push(txt);
    document.getElementById("comment").value = "";
    renderActiveEvent();
}

/* ------------------------------
   SERVICES
--------------------------------*/
function sendService(s) {
    if (!activeEvent) return;
    activeEvent.services.push(s);

    if (activeEvent.dossierSent) {
        const a = actions.find(a => a.id === activeEvent.id);
        if (a) a.services = [...activeEvent.services];
        else actions.push({
            id: activeEvent.id,
            label: activeEvent.scenario.label,
            time: new Date().toLocaleTimeString(),
            services: [...activeEvent.services]
        });
        renderActions();
    }
    renderActiveEvent();
}

function renderActions() {
    const div = document.getElementById("actions");
    div.innerHTML = actions.map(a => `
        <div class="card">
            <b>Dossier #${a.id}</b> â€“ ${a.label}<br>
            <span class="small-label">EnvoyÃ© Ã  ${a.time}</span><br>
            Services engagÃ©s : ${a.services.length ? a.services.join(", ") : "Aucun"}
        </div>
    `).join("");
}

/* ------------------------------
   CLÃ”TURE
--------------------------------*/
function closeEvent() {
    if (!activeEvent) return;
    history.push(activeEvent);
    actions = actions.filter(a => a.id !== activeEvent.id);
    activeEvent = null;
    renderActiveEvent();
    renderActions();
    renderHistory();
}

function renderHistory() {
    const div = document.getElementById("history");
    div.innerHTML = history.map(h => `
        <div class="card">
            <b>#${h.id}</b> â€“ ${h.scenario.label}<br>
            GravitÃ© : ${h.gravity} â€“ Environnement : ${h.env}<br>
            PortÃ©e : ${h.impactScope} â€“ Utilisateurs : ${h.userAffected}<br>
            Services : ${h.services.join(", ") || "Aucun"}<br>
            Commentaires : ${h.comments.length}<br>
            Tag : ${h.tag || "N/A"}
        </div>
    `).join("");
}

/* ------------------------------
   STATISTIQUES
--------------------------------*/
setInterval(() => {
    document.getElementById("stats").innerHTML =
        `En attente: ${queue.length} | En cours: ${activeEvent ? "#"+activeEvent.id : "aucun"} | EnvoyÃ©s: ${actions.length} | Historique: ${history.length}`;
}, 500);

/* ------------------------------
   GÃ‰NÃ‰RATION RÃ‰GULIÃˆRE
--------------------------------*/
setInterval(() => generateEvent(), 15000 + Math.random()*15000);


</script>

</body>
</html>
