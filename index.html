<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <title>Poste de Régulation - Métro</title>
  <style>
    body {
      margin: 0;
      background: #050608;
      color: #f5f5f5;
      font-family: system-ui, sans-serif;
    }

    header {
      padding: 16px 24px;
      background: #111318;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid #22252b;
    }

    .logo {
      width: 34px;
      height: 34px;
      border-radius: 50%;
      background: radial-gradient(circle at 30% 30%, #00ff9d, #007a5a);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 18px;
    }

    main {
      display: grid;
      grid-template-columns: 2fr 1fr;
      min-height: calc(100vh - 80px);
    }

    .board {
      padding: 24px;
      border-right: 1px solid #22252b;
    }

    table {
      width: 100%;
      border-collapse: collapse;
      font-size: 15px;
    }

    th, td {
      padding: 10px 8px;
      border-bottom: 1px solid #22252b;
    }

    tbody tr:nth-child(even) { background: #101219; }
    tbody tr:nth-child(odd) { background: #080a10; }

    .line-badge {
      padding: 4px 10px;
      border-radius: 999px;
      font-weight: 700;
      font-size: 13px;
      color: #000;
    }

    .line-1 { background: #ffcd00; }
    .line-4 { background: #00a651; color: #fff; }
    .line-14 { background: #6ec4e8; }
    .line-A { background: #e2001a; color: #fff; }

    .controls {
      padding: 24px;
    }

    .control-group {
      margin-bottom: 20px;
      padding: 12px;
      background: #0b0d13;
      border: 1px solid #22252b;
      border-radius: 8px;
    }

    select, input {
      width: 100%;
      padding: 6px 8px;
      background: #050608;
      border: 1px solid #333745;
      border-radius: 4px;
      color: #fff;
    }

    button {
      padding: 8px 12px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      background: #1f6feb;
      color: #fff;
      margin-right: 6px;
      margin-top: 6px;
    }

    button.danger { background: #d73a49; }
    button.secondary { background: #303342; }
  </style>
</head>
<body>

<header>
  <div style="display:flex; align-items:center; gap:12px;">
    <div class="logo">M</div>
    <div>
      <div style="font-size:20px; font-weight:600;">Châtelet - Les Halles</div>
      <div style="font-size:12px; color:#9fa3b5;">Simulation temps réel</div>
    </div>
  </div>
  <div id="clock" style="font-size:18px; font-variant-numeric: tabular-nums;"></div>
</header>

<main>
  <section class="board">
    <h2>Prochains passages</h2>
    <table>
      <thead>
        <tr>
          <th>Ligne</th>
          <th>Destination</th>
          <th>Quai</th>
          <th>Dans</th>
          <th>Statut</th>
        </tr>
      </thead>
      <tbody id="board-body"></tbody>
    </table>
  </section>

  <aside class="controls">
    <h2>Panneau de régulation</h2>

    <div class="control-group">
      <label>Train à modifier</label>
      <select id="train-select"></select>
    </div>

    <div class="control-group">
      <label>Nouveau temps (minutes)</label>
      <input type="number" id="new-time" min="0" value="3">
      <button onclick="applyTime()">Appliquer</button>
    </div>

    <div class="control-group">
      <label>Retard</label>
      <button class="secondary" onclick="addDelay(2)">+2 min</button>
      <button class="secondary" onclick="addDelay(5)">+5 min</button>
      <button class="danger" onclick="setIncident()">Incident</button>
    </div>

    <div class="control-group">
      <label>Actions globales</label>
      <button onclick="randomize()">Randomiser</button>
      <button class="danger" onclick="resetAll()">Réinitialiser</button>
    </div>
  </aside>
</main>

<script>
  const trains = [
    { line: "1", class: "line-1", dest: "La Défense", quai: "A", time: 2, status: "OK" },
    { line: "4", class: "line-4", dest: "Mairie de Montrouge", quai: "B", time: 5, status: "OK" },
    { line: "14", class: "line-14", dest: "Olympiades", quai: "C", time: 7, status: "OK" },
    { line: "A", class: "line-A", dest: "Marne-la-Vallée", quai: "D", time: 3, status: "OK" }
  ];

  function renderBoard() {
    const tbody = document.getElementById("board-body");
    tbody.innerHTML = "";

    trains.forEach((t, i) => {
      tbody.innerHTML += `
        <tr>
          <td><span class="line-badge ${t.class}">${t.line}</span></td>
          <td>${t.dest}</td>
          <td>${t.quai}</td>
          <td style="text-align:right;">${t.time} min</td>
          <td style="text-align:right; color:${t.status === "OK" ? "#00d084" : t.status === "Incident" ? "#ff5c5c" : "#ffb347"};">
            ${t.status}
          </td>
        </tr>
      `;
    });

    const select = document.getElementById("train-select");
    select.innerHTML = trains.map((t, i) => `<option value="${i}">${t.line} → ${t.dest}</option>`).join("");
  }

  function applyTime() {
    const i = document.getElementById("train-select").value;
    const newTime = parseInt(document.getElementById("new-time").value);
    trains[i].time = newTime;
    trains[i].status = "OK";
    renderBoard();
  }

  function addDelay(min) {
    const i = document.getElementById("train-select").value;
    trains[i].time += min;
    trains[i].status = "Retard";
    renderBoard();
  }

  function setIncident() {
    const i = document.getElementById("train-select").value;
    trains[i].status = "Incident";
    renderBoard();
  }

  function randomize() {
    trains.forEach(t => {
      t.time = Math.floor(Math.random() * 10) + 1;
      t.status = ["OK", "Retard", "Incident"][Math.floor(Math.random() * 3)];
    });
    renderBoard();
  }

  function resetAll() {
    trains.forEach(t => {
      t.time = 3;
      t.status = "OK";
    });
    renderBoard();
  }

  function updateClock() {
    const now = new Date();
    document.getElementById("clock").textContent =
      now.toLocaleTimeString("fr-FR", { hour: "2-digit", minute: "2-digit", second: "2-digit" });
  }

  setInterval(updateClock, 1000);
  updateClock();
  renderBoard();
</script>

</body>
</html>
