<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>Pannel de Secours - Simulation</title>
<style>
    body {
        margin: 0;
        font-family: Arial, sans-serif;
        background: #1b1b1b;
        color: white;
        display: flex;
        height: 100vh;
    }
    header {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        background: #111;
        padding: 10px;
        text-align: center;
        z-index: 10;
        border-bottom: 2px solid #333;
    }
    .container {
        display: flex;
        width: 100%;
        margin-top: 60px;
    }
    .column {
        flex: 1;
        padding: 10px;
        overflow-y: auto;
        border-right: 2px solid #333;
    }
    .column:last-child {
        border-right: none;
    }
    .call-card {
        background: #2a2a2a;
        padding: 10px;
        margin-bottom: 10px;
        border-left: 5px solid #555;
    }
    .btn {
        padding: 6px 10px;
        margin: 3px;
        background: #444;
        border: none;
        color: white;
        cursor: pointer;
    }
    .btn:hover {
        background: #666;
    }
    .service-btn {
        background: #0055aa;
    }
    .service-btn:hover {
        background: #0077dd;
    }
    textarea {
        width: 100%;
        height: 80px;
        background: #222;
        color: white;
        border: 1px solid #444;
        padding: 5px;
    }
    .section-title {
        font-size: 20px;
        margin-bottom: 10px;
        border-bottom: 1px solid #444;
        padding-bottom: 5px;
    }
</style>
</head>
<body>

<header>
    <h2>Centre de Traitement des Appels d'Urgence â€“ Simulation</h2>
    <div id="stats"></div>
</header>

<div class="container">

    <!-- FILE D'APPELS -->
    <div class="column" id="queue">
        <div class="section-title">ðŸ“ž Appels entrants</div>
        <div id="queue-list"></div>
    </div>

    <!-- APPEL ACTIF -->
    <div class="column" id="active">
        <div class="section-title">ðŸŽ§ Appel en cours</div>
        <div id="active-call">Aucun appel sÃ©lectionnÃ©.</div>
    </div>

    <!-- ACTIONS + HISTORIQUE -->
    <div class="column">
        <div class="section-title">ðŸš¨ Actions en cours</div>
        <div id="actions"></div>

        <div class="section-title" style="margin-top:20px;">ðŸ“š Historique</div>
        <div id="history"></div>
    </div>

</div>

<script>
/* ------------------------------
   BASE DE DONNÃ‰ES SCÃ‰NARIOS
--------------------------------*/
const SCENARIOS = [
    {label:"ArrÃªt cardio-respiratoire", type:"MÃ©dical", prio:"P0", desc:"Victime inconsciente, ne respire plus.", victims:1},
    {label:"Feu d'appartement", type:"Incendie", prio:"P0", desc:"FumÃ©e importante, personnes coincÃ©es.", victims:2},
    {label:"Accident route", type:"Accident", prio:"P1", desc:"Collision, blessÃ© coincÃ©.", victims:1},
    {label:"Agression couteau", type:"Agression", prio:"P0", desc:"Victime poignardÃ©e.", victims:1},
    {label:"Vieil homme perdu", type:"MÃ©dical", prio:"P2", desc:"Personne Ã¢gÃ©e confuse.", victims:1},
    {label:"Odeur de gaz", type:"Risque", prio:"P1", desc:"Forte odeur de gaz.", victims:0},
    {label:"Appel OVNI", type:"Bizarre", prio:"P3", desc:"Personne dit Ãªtre observÃ©e par un OVNI.", victims:0},
    {label:"Enfant qui rigole", type:"Douteux", prio:"P3", desc:"Probable faux appel.", victims:0},
    {label:"Suicide pont", type:"Critique", prio:"P0", desc:"Personne menace de sauter.", victims:1},
    {label:"Malaise mÃ©tro", type:"MÃ©dical", prio:"P1", desc:"Victime inconsciente sur quai.", victims:1},
    {label:"Voisin hurle 'je suis un poulet'", type:"Bizarre", prio:"P3", desc:"Appel trÃ¨s confus.", victims:0},
    {label:"Course poursuite scooter", type:"Police", prio:"P1", desc:"Scooter refuse d'obtempÃ©rer.", victims:0},
    {label:"Trafic suspect", type:"Douanes", prio:"P2", desc:"Camionnette suspecte prÃ¨s d'un entrepÃ´t.", victims:0}
];

/* ------------------------------
   VARIABLES
--------------------------------*/
let queue = [];
let activeCall = null;
let actions = [];
let history = [];
let callID = 1;

/* ------------------------------
   GENERATEUR D'APPELS
--------------------------------*/
function generateCall() {
    const s = SCENARIOS[Math.floor(Math.random()*SCENARIOS.length)];
    const call = {
        id: callID++,
        scenario: s,
        time: new Date().toLocaleTimeString(),
        location: randomLocation(),
        comments: [],
        services: [],
        status: "En attente"
    };
    queue.push(call);
    renderQueue();
}

function randomLocation() {
    const streets = ["Rue Victor Hugo", "Avenue de Paris", "Boulevard des Lilas", "Rue du Port", "Chemin des Vignes"];
    return streets[Math.floor(Math.random()*streets.length)] + ", " + (Math.floor(Math.random()*50)+1);
}

/* ------------------------------
   AFFICHAGE FILE D'APPELS
--------------------------------*/
function renderQueue() {
    const div = document.getElementById("queue-list");
    div.innerHTML = "";
    queue.forEach(call => {
        div.innerHTML += `
            <div class="call-card">
                <b>#${call.id}</b> â€“ ${call.scenario.label}<br>
                <i>${call.scenario.prio}</i> â€“ ${call.location}<br>
                <button class="btn" onclick="takeCall(${call.id})">Prendre en charge</button>
            </div>
        `;
    });
}

/* ------------------------------
   PRENDRE UN APPEL
--------------------------------*/
function takeCall(id) {
    activeCall = queue.find(c => c.id === id);
    queue = queue.filter(c => c.id !== id);
    renderQueue();
    renderActiveCall();
}

/* ------------------------------
   AFFICHAGE APPEL ACTIF
--------------------------------*/
function renderActiveCall() {
    if (!activeCall) {
        document.getElementById("active-call").innerHTML = "Aucun appel sÃ©lectionnÃ©.";
        return;
    }

    document.getElementById("active-call").innerHTML = `
        <div class="call-card">
            <h3>Appel #${activeCall.id}</h3>
            <b>${activeCall.scenario.label}</b><br>
            Type : ${activeCall.scenario.type}<br>
            PrioritÃ© : ${activeCall.scenario.prio}<br>
            Victimes : ${activeCall.scenario.victims}<br>
            Localisation : ${activeCall.location}<br>
            <p>${activeCall.scenario.desc}</p>

            <h4>Commentaires</h4>
            <textarea id="comment"></textarea>
            <button class="btn" onclick="addComment()">Ajouter</button>
            <div id="comment-list">${activeCall.comments.map(c=>"<div>â€¢ "+c+"</div>").join("")}</div>

            <h4>Envoyer des services</h4>
            ${serviceButton("SAMU")}
            ${serviceButton("Pompiers")}
            ${serviceButton("Police")}
            ${serviceButton("Gendarmerie")}
            ${serviceButton("SMUR")}
            ${serviceButton("HÃ©lico")}
            ${serviceButton("DOC")}
            ${serviceButton("Douanes")}

            <h4>Statut</h4>
            <button class="btn" onclick="closeCall()">ClÃ´turer l'appel</button>
        </div>
    `;
}

function serviceButton(name) {
    return `<button class="btn service-btn" onclick="sendService('${name}')">${name}</button>`;
}

/* ------------------------------
   COMMENTAIRES
--------------------------------*/
function addComment() {
    const txt = document.getElementById("comment").value.trim();
    if (!txt) return;
    activeCall.comments.push(txt);
    renderActiveCall();
}

/* ------------------------------
   ENVOI DE SERVICES
--------------------------------*/
function sendService(s) {
    activeCall.services.push(s);
    actions.push({call: activeCall.id, service: s, time: new Date().toLocaleTimeString()});
    renderActions();
    renderActiveCall();
}

function renderActions() {
    const div = document.getElementById("actions");
    div.innerHTML = actions.map(a => `
        <div class="call-card">
            #${a.call} â€“ ${a.service} envoyÃ© Ã  ${a.time}
        </div>
    `).join("");
}

/* ------------------------------
   CLÃ”TURE APPEL
--------------------------------*/
function closeCall() {
    history.push(activeCall);
    activeCall = null;
    renderActiveCall();
    renderHistory();
}

function renderHistory() {
    const div = document.getElementById("history");
    div.innerHTML = history.map(h => `
        <div class="call-card">
            <b>#${h.id}</b> â€“ ${h.scenario.label}<br>
            Services envoyÃ©s : ${h.services.join(", ") || "Aucun"}<br>
            Commentaires : ${h.comments.length}
        </div>
    `).join("");
}

/* ------------------------------
   STATISTIQUES
--------------------------------*/
setInterval(() => {
    document.getElementById("stats").innerHTML =
        `Appels en attente: ${queue.length} | En cours: ${activeCall ? 1 : 0} | Historique: ${history.length}`;
}, 500);

/* ------------------------------
   LANCEMENT AUTOMATIQUE
--------------------------------*/
setInterval(() => generateCall(), 15000 + Math.random()*5000); // 3â€“4 appels/min

</script>

</body>
</html>

